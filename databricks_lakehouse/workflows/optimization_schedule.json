{
  "name": "lakehouse-optimization-schedule",
  "email_notifications": {
    "on_success": ["data-engineering@company.com"],
    "on_failure": ["data-engineering@company.com"]
  },
  "timeout_seconds": 3600,
  "max_concurrent_runs": 1,
  "format": "MULTI_TASK",
  "tasks": [
    {
      "task_key": "optimize_bronze",
      "description": "Optimize Bronze layer tables",
      "notebook_task": {
        "notebook_path": "/Shared/lakehouse/notebooks/09_performance_optimization",
        "base_parameters": {
          "layer": "bronze",
          "optimize": "true",
          "vacuum": "true"
        }
      },
      "job_cluster_key": "analytics_cluster",
      "timeout_seconds": 1800
    },
    {
      "task_key": "optimize_silver",
      "description": "Optimize Silver layer tables with Z-ordering",
      "depends_on": [
        {
          "task_key": "optimize_bronze"
        }
      ],
      "notebook_task": {
        "notebook_path": "/Shared/lakehouse/notebooks/09_performance_optimization",
        "base_parameters": {
          "layer": "silver",
          "optimize": "true",
          "z_order": "true",
          "bloom_filter": "true"
        }
      },
      "job_cluster_key": "analytics_cluster",
      "timeout_seconds": 1800
    },
    {
      "task_key": "optimize_gold",
      "description": "Optimize Gold layer tables",
      "depends_on": [
        {
          "task_key": "optimize_silver"
        }
      ],
      "notebook_task": {
        "notebook_path": "/Shared/lakehouse/notebooks/09_performance_optimization",
        "base_parameters": {
          "layer": "gold",
          "optimize": "true",
          "z_order": "true"
        }
      },
      "job_cluster_key": "analytics_cluster",
      "timeout_seconds": 1800
    }
  ],
  "job_clusters": [
    {
      "job_cluster_key": "analytics_cluster",
      "new_cluster": {
        "cluster_name": "optimization-cluster",
        "spark_version": "14.3.x-scala2.12",
        "node_type_id": "i3.xlarge",
        "driver_node_type_id": "i3.xlarge",
        "num_workers": 2,
        "spark_conf": {
          "spark.databricks.delta.optimizeWrite.enabled": "true",
          "spark.sql.adaptive.enabled": "true"
        }
      }
    }
  ],
  "schedule": {
    "quartz_cron_expression": "0 0 2 * * ?",
    "timezone_id": "America/New_York",
    "pause_status": "UNPAUSED"
  }
}
